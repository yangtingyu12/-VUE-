(function(){var t={7630:function(t,e,s){"use strict";s(2042);var i=s(8521),a=(s(5002),s(2476)),n=(s(5440),s(1914)),r=(s(9892),s(6458)),o=(s(8627),s(5641)),l=(s(8029),s(4951)),c=(s(2355),s(9233)),u=(s(3307),s(1392)),d=(s(9432),s(2591)),h=(s(5559),s(5553)),p=s(144),f=function(){var t=this,e=t._self._c;return e("div",[e("router-view")],1)},m=[],v={},g=v,y=s(1001),_=(0,y.Z)(g,f,m,!1,null,null,null),w=_.exports,L=(s(1305),s(8345)),b=function(){var t=this,e=t._self._c;return e("div",[e("van-nav-bar",{attrs:{title:t.activeTitle,fixed:""}}),e("div",{staticClass:"main"},[e("router-view")],1),e("van-tabbar",{attrs:{route:""}},[e("van-tabbar-item",{attrs:{replace:"",to:"/layout/home",icon:"home-o"}},[t._v("首页")]),e("van-tabbar-item",{attrs:{replace:"",to:"/layout/search",icon:"search"}},[t._v("搜索")])],1)],1)},Z=[],C={data(){return{activeTitle:this.$route.meta.title}},watch:{$route(){this.activeTitle=this.$route.meta.title}}},S=C,x=(0,y.Z)(S,b,Z,!1,null,"205b271b",null),k=x.exports,$=function(){var t=this,e=t._self._c;return e("div",[e("div",[e("p",{staticClass:"title"},[t._v("推荐歌单")]),e("van-row",{attrs:{gutter:"6"}},t._l(t.reList,(function(s){return e("van-col",{key:s.id,attrs:{span:"8"}},[e("van-image",{attrs:{width:"100%",height:"3rem",fit:"cover",src:s.picUrl}}),e("p",{staticClass:"song_name"},[t._v(t._s(s.name))])],1)})),1)],1),e("p",{staticClass:"title"},[t._v("最新音乐")]),t._l(t.songList,(function(t){return e("SongItem",{key:t.id,attrs:{name:t.name,author:t.song.artists[0].name,id:t.id}})}))],2)},I=[],P=s(9669),O=s.n(P);O().defaults.baseURL="http://localhost:3000";var E=O();const T=t=>E({url:"/personalized",params:t}),F=t=>E({url:"/personalized/newsong",params:t}),z=t=>E({url:"/search/hot",params:t}),j=t=>E({url:"/cloudsearch",params:t}),q=t=>E({url:`/song/detail?ids=${t}`,method:"GET"}),U=t=>E({url:`/lyric?id=${t}`,method:"GET"}),A=T,D=F,M=z,N=j,G=q,R=U;var V=function(){var t=this,e=t._self._c;return e("van-cell",{attrs:{center:"",title:t.name,label:t.author+" - "+t.name},scopedSlots:t._u([{key:"right-icon",fn:function(){return[e("van-icon",{attrs:{name:"play-circle-o",size:"0.6rem"},on:{click:t.playFn}})]},proxy:!0}])})},H=[],W={props:{name:String,author:String,id:Number},methods:{playFn(){this.$router.push({path:"/play",query:{id:this.id}})}}},B=W,J=(0,y.Z)(B,V,H,!1,null,"cb109d04",null),K=J.exports,Q={data(){return{reList:[],songList:[]}},async created(){const t=await A({limit:6});console.log(t),this.reList=t.data.result;const e=await D({limit:20});console.log(e),this.songList=e.data.result},components:{SongItem:K}},X=Q,Y=(0,y.Z)(X,$,I,!1,null,"1cda3f9c",null),tt=Y.exports,et=function(){var t=this,e=t._self._c;return e("div",[e("van-search",{attrs:{shape:"round",placeholder:"请输入搜索关键词"},on:{input:t.inputFn},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}}),0===t.resultList.length?e("div",{staticClass:"search_wrap"},[e("p",{staticClass:"hot_title"},[t._v("热门搜索")]),e("div",{staticClass:"hot_name_wrap"},t._l(t.hotArr,(function(s,i){return e("span",{key:i,staticClass:"hot_item",on:{click:function(e){return t.fn(s.first)}}},[t._v(t._s(s.first))])})),0)]):e("div",{staticClass:"search_wrap"},[e("p",{staticClass:"hot_title"},[t._v("最佳匹配")]),e("van-list",{attrs:{finished:t.finished,"finished-text":"没有更多了"},on:{load:t.onLoad},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},t._l(t.resultList,(function(t){return e("SongItem",{key:t.id,attrs:{name:t.name,author:t.ar[0].name,id:t.id}})})),1)],1)],1)},st=[],it={data(){return{value:"",hotArr:[],resultList:[],loading:!1,finished:!1,page:1,timer:null}},async created(){const t=await M();console.log(t),this.hotArr=t.data.result.hots},methods:{async getListFn(){return await N({keywords:this.value,limit:20,offset:20*(this.page-1)})},async fn(t){this.page=1,this.finished=!1,this.value=t;const e=await this.getListFn();console.log(e),this.resultList=e.data.result.songs,this.loading=!1},async inputFn(){this.timer&&clearTimeout(this.timer),this.timer=setTimeout((async()=>{if(this.page=1,this.finished=!1,0===this.value.length)return void(this.resultList=[]);const t=await this.getListFn();console.log(t),void 0!==t.data.result.songs?(this.resultList=t.data.result.songs,this.loading=!1):this.resultList=[]}),900)},async onLoad(){this.page++;const t=await this.getListFn();if(void 0===t.data.result.songs)return this.finished=!0,void(this.loading=!1);this.resultList=[...this.resultList,...t.data.result.songs],this.loading=!1}},components:{SongItem:K}},at=it,nt=(0,y.Z)(at,et,st,!1,null,"7c2bf3ca",null),rt=nt.exports,ot=function(){var t=this,e=t._self._c;return e("div",{staticClass:"play"},[e("div",{staticClass:"song-bg",style:`background-image: url(${t.songInfo&&t.songInfo.al&&t.songInfo.al.picUrl}?imageView&thumbnail=360y360&quality=75&tostatic=0);`}),e("div",{staticClass:"header"},[e("van-icon",{staticClass:"left-incon",attrs:{name:"arrow-left",size:"20"},on:{click:function(e){return t.$router.back()}}})],1),e("div",{staticClass:"song-wrapper"},[e("div",{staticClass:"song-turn ani",style:"animation-play-state:"+(t.playState?"running":"paused")},[e("div",{staticClass:"song-img"},[e("img",{staticStyle:{width:"100%"},attrs:{src:`${t.songInfo&&t.songInfo.al&&t.songInfo.al.picUrl}?imageView&thumbnail=360y360&quality=75&tostatic=0`,alt:""}})])]),e("div",{staticClass:"start-box",on:{click:t.audioStart}},[e("span",{directives:[{name:"show",rawName:"v-show",value:!t.playState,expression:"!playState"}],staticClass:"song-start"})]),e("div",{staticClass:"song-msg"},[e("h2",{staticClass:"m-song-h2"},[e("span",{staticClass:"m-song-sname"},[t._v(t._s(t.songInfo.name)+"-"+t._s(t.songInfo&&t.songInfo.ar&&t.songInfo.ar[0].name))])]),e("div",{staticClass:"lrcContent"},[e("p",{staticClass:"lrc"},[t._v(t._s(t.curLyric))])])]),e("div",{staticClass:"needle",style:`transform: rotate(${t.needleDeg});`})]),e("audio",{ref:"audio",attrs:{preload:"true",src:`https://music.163.com/song/media/outer/url?id=${t.id}.mp3`}})])},lt=[],ct={components:{[u.Z.name]:u.Z},name:"play",data(){return{playState:!1,id:this.$route.query.id,songInfo:{},lyric:{},curLyric:"",lastLy:""}},computed:{needleDeg(){return this.playState?"-7deg":"-38deg"}},methods:{async getSong(){const t=await G(this.id);this.songInfo=t.data.songs[0];const e=await R(this.id),s=e.data.lrc.lyric;this.lyric=this._formatLyr(s),this.curLyric=this.lyric[0]},_formatLyr(t){let e=/\[.+?\]/g,s=t.match(e);console.log(s);let i=t.split(/\[.+?\]/).slice(1);console.log(i);let a={};return s.forEach(((t,e)=>{let s=60*t.split(":")[0].split("")[2],n="0"===t.split(":")[1].split(".")[0].split("")[0]?t.split(":")[1].split(".")[0].split("")[1]:t.split(":")[1].split(".")[0];a[s+Number(n)]=i[e]})),console.log(a),a},audioStart(){this.playState?this.$refs.audio.pause():this.$refs.audio.play(),this.playState=!this.playState},showLyric(){this.$refs.audio.addEventListener("timeupdate",(()=>{let t=Math.floor(this.$refs.audio.currentTime);this.lyric[t]?(this.curLyric=this.lyric[t],this.lastLy=this.curLyric):this.curLyric=this.lastLy}))}},mounted(){this.getSong(),this.showLyric(),console.log(this.$route.query.id)}},ut=ct,dt=(0,y.Z)(ut,ot,lt,!1,null,"4f6ac304",null),ht=dt.exports;p.ZP.use(L.Z);const pt=[{path:"/",redirect:"/layout"},{path:"/layout",component:k,redirect:"/layout/home",children:[{path:"home",component:tt,meta:{title:"首页"}},{path:"search",component:rt,meta:{title:"搜索"}}]},{path:"/play",component:ht}],ft=new L.Z({routes:pt});var mt=ft;p.ZP.use(h.Z),p.ZP.use(d.Z),p.ZP.use(u.Z),p.ZP.use(c.Z),p.ZP.use(l.Z),p.ZP.use(o.Z),p.ZP.use(r.Z),p.ZP.use(n.Z),p.ZP.use(a.Z),p.ZP.use(i.Z),p.ZP.config.productionTip=!1,new p.ZP({router:mt,render:t=>t(w)}).$mount("#app")},1305:function(){(function(t,e){var s=e.documentElement,i=t.devicePixelRatio||1;function a(){e.body?e.body.style.fontSize=12*i+"px":e.addEventListener("DOMContentLoaded",a)}function n(){var t=s.clientWidth/10;s.style.fontSize=t+"px"}if(a(),n(),t.addEventListener("resize",n),t.addEventListener("pageshow",(function(t){t.persisted&&n()})),i>=2){var r=e.createElement("body"),o=e.createElement("div");o.style.border=".5px solid transparent",r.appendChild(o),s.appendChild(r),1===o.offsetHeight&&s.classList.add("hairlines"),s.removeChild(r)}})(window,document)}},e={};function s(i){var a=e[i];if(void 0!==a)return a.exports;var n=e[i]={exports:{}};return t[i](n,n.exports,s),n.exports}s.m=t,function(){var t=[];s.O=function(e,i,a,n){if(!i){var r=1/0;for(u=0;u<t.length;u++){i=t[u][0],a=t[u][1],n=t[u][2];for(var o=!0,l=0;l<i.length;l++)(!1&n||r>=n)&&Object.keys(s.O).every((function(t){return s.O[t](i[l])}))?i.splice(l--,1):(o=!1,n<r&&(r=n));if(o){t.splice(u--,1);var c=a();void 0!==c&&(e=c)}}return e}n=n||0;for(var u=t.length;u>0&&t[u-1][2]>n;u--)t[u]=t[u-1];t[u]=[i,a,n]}}(),function(){s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,{a:e}),e}}(),function(){s.d=function(t,e){for(var i in e)s.o(e,i)&&!s.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})}}(),function(){s.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){var t={143:0};s.O.j=function(e){return 0===t[e]};var e=function(e,i){var a,n,r=i[0],o=i[1],l=i[2],c=0;if(r.some((function(e){return 0!==t[e]}))){for(a in o)s.o(o,a)&&(s.m[a]=o[a]);if(l)var u=l(s)}for(e&&e(i);c<r.length;c++)n=r[c],s.o(t,n)&&t[n]&&t[n][0](),t[n]=0;return s.O(u)},i=self["webpackChunkmusic_dome"]=self["webpackChunkmusic_dome"]||[];i.forEach(e.bind(null,0)),i.push=e.bind(null,i.push.bind(i))}();var i=s.O(void 0,[998],(function(){return s(7630)}));i=s.O(i)})();
//# sourceMappingURL=app.624c1d2c.js.map